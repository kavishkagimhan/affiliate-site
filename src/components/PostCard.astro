---
interface Props {
  title: string;
  description: string;
  image?: string;
  date?: Date;
  category?: string;
  slug: string;
}

const { title, description, image = 'https://images.unsplash.com/photo-1499750310107-5fef28a66643?auto=format&fit=crop&w=800&q=80', date, category, slug } = Astro.props;

const formattedDate = date ? new Date(date).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'short',
  day: 'numeric'
}) : '';
---

<article class="post-card group" data-animate>
  <div class="post-card-image-wrapper">
    <a href={`/posts/${slug}`} class="post-card-image-link" aria-label={`Read more about ${title}`}>
      <img 
        src={image} 
        alt={title}
        class="post-card-image"
        loading="lazy"
        decoding="async"
        width="400"
        height="280"
      />
      <div class="post-card-overlay">
        <div class="post-card-overlay-content">
          <svg class="w-16 h-16 text-white opacity-0 group-hover:opacity-100 transform scale-75 group-hover:scale-100 transition-all duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
          </svg>
        </div>
      </div>
      {category && (
        <div class="post-card-category">
          <span class="post-card-category-badge glass">{category}</span>
        </div>
      )}
    </a>
  </div>
  <div class="post-card-content">
    <h2 class="post-card-title">
      <a href={`/posts/${slug}`} class="post-card-title-link">
        {title}
      </a>
    </h2>
    <p class="post-card-description">{description}</p>
    <div class="post-card-footer">
      {date && (
        <time datetime={date?.toISOString()} class="post-card-date">
          <svg class="w-4 h-4 inline-block mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          {formattedDate}
        </time>
      )}
      <a href={`/posts/${slug}`} class="post-card-button">
        Read More
        <svg class="post-card-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
        </svg>
      </a>
    </div>
  </div>
</article>

<style>
  .post-card {
    @apply bg-base-100 rounded-3xl overflow-hidden shadow-lg transition-all duration-500;
    border: 1px solid transparent;
    will-change: transform, box-shadow;
    /* GPU acceleration for better performance */
    transform: translateZ(0);
    backface-visibility: hidden;
  }

  .post-card:hover {
    @apply border-primary-200/50;
    transform: translateY(-12px) scale(1.02) translateZ(0);
    box-shadow: 
      0 25px 50px -12px rgb(0 0 0 / 0.15),
      0 0 0 1px rgb(14 165 233 / 0.1),
      0 0 30px rgb(14 165 233 / 0.1);
  }

  .post-card-image-wrapper {
    @apply relative overflow-hidden;
    aspect-ratio: 16 / 10;
  }

  .post-card-image-link {
    @apply block w-full h-full;
  }

  .post-card-image {
    @apply w-full h-full object-cover;
    transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
    will-change: transform;
  }

  .post-card:hover .post-card-image {
    transform: scale(1.1) rotate(1deg);
  }

  .post-card-overlay {
    @apply absolute inset-0 flex items-center justify-center;
    @apply bg-gradient-to-t from-black/80 via-black/40 to-transparent;
    opacity: 0;
    transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .post-card:hover .post-card-overlay {
    opacity: 1;
  }

  .post-card-overlay-content {
    @apply flex items-center justify-center;
  }

  .post-card-category {
    @apply absolute top-4 left-4 z-10;
    animation: fadeInDown 0.6s ease-out;
  }

  .post-card-category-badge {
    @apply inline-flex items-center px-4 py-2 rounded-full text-xs font-bold uppercase tracking-wider;
    @apply text-white shadow-xl;
    background: rgba(14, 165, 233, 0.9);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
  }

  .post-card:hover .post-card-category-badge {
    background: rgba(14, 165, 233, 1);
    transform: scale(1.05);
  }

  .post-card-content {
    @apply p-7;
  }

  .post-card-title {
    @apply text-xl font-bold mb-4 line-clamp-2;
    letter-spacing: -0.02em;
  }

  .post-card-title-link {
    @apply text-base-content transition-all duration-300;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    background: linear-gradient(135deg, transparent 0%, transparent 100%);
    background-size: 0% 100%;
    background-repeat: no-repeat;
    transition: all 0.4s ease;
  }

  .post-card:hover .post-card-title-link {
    @apply text-primary-600;
  }

  html[data-theme="dark"] .post-card:hover .post-card-title-link {
    @apply text-primary-400;
  }

  .post-card-description {
    @apply text-sm mb-6 leading-relaxed;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
    color: #4b5563; /* gray-600 for better contrast */
  }

  html[data-theme="dark"] .post-card-description {
    color: #d1d5db; /* gray-300 for dark mode */
  }

  .post-card-footer {
    @apply flex items-center justify-between pt-5 border-t border-base-300/50;
  }

  .post-card-date {
    @apply text-sm text-base-content font-semibold flex items-center;
    transition: color 0.3s ease;
    opacity: 0.75;
  }

  .post-card:hover .post-card-date {
    opacity: 0.9;
  }

  html[data-theme="dark"] .post-card-date {
    @apply text-gray-200;
    opacity: 0.85;
  }

  html[data-theme="dark"] .post-card:hover .post-card-date {
    opacity: 1;
  }

  .post-card-button {
    @apply inline-flex items-center gap-2 px-4 py-2 rounded-lg;
    @apply text-sm font-bold text-primary-700 bg-primary-100;
    @apply hover:bg-primary-200 transition-all duration-300;
    position: relative;
    overflow: hidden;
  }

  .post-card-button::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(14, 165, 233, 0.2);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
  }

  .post-card-button:hover::before {
    width: 300px;
    height: 300px;
  }

  .post-card-button span,
  .post-card-arrow {
    position: relative;
    z-index: 1;
  }

  .post-card-arrow {
    @apply w-4 h-4;
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .post-card-button:hover .post-card-arrow {
    transform: translateX(6px);
  }

  html[data-theme="dark"] .post-card-button {
    @apply text-primary-100 bg-primary-900/70;
  }

  html[data-theme="dark"] .post-card-button:hover {
    @apply bg-primary-900 text-white;
  }

  /* Dark mode adjustments */
  html[data-theme="dark"] .post-card {
    border-color: rgba(75, 85, 99, 0.3);
    background: rgba(30, 41, 59, 0.5);
    backdrop-filter: blur(10px);
  }

  html[data-theme="dark"] .post-card:hover {
    border-color: rgba(56, 189, 248, 0.5);
    box-shadow: 
      0 25px 50px -12px rgb(0 0 0 / 0.5),
      0 0 0 1px rgb(56 189 248 / 0.2),
      0 0 40px rgb(56 189 248 / 0.15);
  }

  html[data-theme="dark"] .post-card-overlay {
    background: linear-gradient(to top, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.5), transparent);
  }


  html[data-theme="dark"] .post-card-category-badge {
    background: rgba(56, 189, 248, 0.9);
    border: 1px solid rgba(255, 255, 255, 0.15);
  }

  html[data-theme="dark"] .post-card:hover .post-card-category-badge {
    background: rgba(56, 189, 248, 1);
  }

  /* Animation for cards on scroll */
  @keyframes fadeInDown {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

